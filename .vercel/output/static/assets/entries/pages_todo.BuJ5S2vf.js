import{r as R,j as p,i as I,o as _,L as N,a as k,b as q}from"../chunks/chunk-CoICkiSo.js";import{u as $}from"../chunks/chunk-CLwBWBYr.js";/* empty css                      */import"../chunks/chunk-Bq821ozC.js";/* empty css                      *//* empty css                      */function H(e){return e}function B(e){return e.length===0?H:e.length===1?e[0]:function(r){return e.reduce((t,i)=>i(t),r)}}function C(e){const n={subscribe(r){let t=null,i=!1,u=!1,a=!1;function c(){if(t===null){a=!0;return}u||(u=!0,typeof t=="function"?t():t&&t.unsubscribe())}return t=e({next(o){var s;i||(s=r.next)==null||s.call(r,o)},error(o){var s;i||(i=!0,(s=r.error)==null||s.call(r,o),c())},complete(){var o;i||(i=!0,(o=r.complete)==null||o.call(r),c())}}),a&&c(),{unsubscribe:c}},pipe(...r){return B(r)(n)}};return n}function M(e){return n=>{let r=0,t=null;const i=[];function u(){t||(t=n.subscribe({next(c){var o;for(const s of i)(o=s.next)==null||o.call(s,c)},error(c){var o;for(const s of i)(o=s.error)==null||o.call(s,c)},complete(){var c;for(const o of i)(c=o.complete)==null||c.call(o)}}))}function a(){if(r===0&&t){const c=t;t=null,c.unsubscribe()}}return{subscribe(c){return r++,i.push(c),u(),{unsubscribe(){r--,a();const o=i.findIndex(s=>s===c);o>-1&&i.splice(o,1)}}}}}}class A extends Error{constructor(n){super(n),this.name="ObservableAbortError",Object.setPrototypeOf(this,A.prototype)}}function F(e){let n;return{promise:new Promise((t,i)=>{let u=!1;function a(){u||(u=!0,i(new A("This operation was aborted.")),c.unsubscribe())}const c=e.subscribe({next(o){u=!0,t(o),a()},error(o){u=!0,i(o),a()},complete(){u=!0,a()}});n=a}),abort:n}}function V(e){return C(n=>{function r(i=0,u=e.op){const a=e.links[i];if(!a)throw new Error("No more links to execute - did you forget to add an ending link?");return a({op:u,next(o){return r(i+1,o)}})}return r().subscribe(n)})}function O(e){const n=Object.create(null);for(const r in e){const t=e[r];n[t]=r}return n}const U={PARSE_ERROR:-32700,BAD_REQUEST:-32600,INTERNAL_SERVER_ERROR:-32603,NOT_IMPLEMENTED:-32603,UNAUTHORIZED:-32001,FORBIDDEN:-32003,NOT_FOUND:-32004,METHOD_NOT_SUPPORTED:-32005,TIMEOUT:-32008,CONFLICT:-32009,PRECONDITION_FAILED:-32012,PAYLOAD_TOO_LARGE:-32013,UNPROCESSABLE_CONTENT:-32022,TOO_MANY_REQUESTS:-32029,CLIENT_CLOSED_REQUEST:-32099};O(U);O(U);const D=()=>{};function z(e,n){return new Proxy(D,{get(t,i){if(!(typeof i!="string"||i==="then"))return z(e,[...n,i])},apply(t,i,u){const a=n[n.length-1]==="apply";return e({args:a?u.length>=2?u[1]:[]:u,path:a?n.slice(0,-1):n})}})}const J=e=>z(e,[]),Y=e=>new Proxy(D,{get(n,r){if(!(typeof r!="string"||r==="then"))return e(r)}});function G(e){return!!e&&!Array.isArray(e)&&typeof e=="object"}class Q extends Error{}function K(e){if(e instanceof Error)return e;const n=typeof e;if(!(n==="undefined"||n==="function"||e===null)){if(n!=="object")return new Error(String(e));if(G(e)){const r=new Q;for(const t in e)r[t]=e[t];return r}}}function x(e){return!!e&&!Array.isArray(e)&&typeof e=="object"}function Z(e,n){if("error"in e){const t=n.transformer.deserialize(e.error);return{ok:!1,error:{...e,error:t}}}return{ok:!0,result:{...e.result,...(!e.result.type||e.result.type==="data")&&{type:"data",data:n.transformer.deserialize(e.result.data)}}}}class E extends Error{constructor(){super("Unable to transform response from server")}}function W(e,n){let r;try{r=Z(e,n)}catch{throw new E}if(!r.ok&&(!x(r.error.error)||typeof r.error.error.code!="number"))throw new E;if(r.ok&&!x(r.result))throw new E;return r}function X(e){return e instanceof T||e instanceof Error&&e.name==="TRPCClientError"}function ee(e){return x(e)&&x(e.error)&&typeof e.error.code=="number"&&typeof e.error.message=="string"}class T extends Error{static from(n,r={}){const t=n;return X(t)?(r.meta&&(t.meta={...t.meta,...r.meta}),t):ee(t)?new T(t.error.message,{...r,result:t}):t instanceof Error?new T(t.message,{...r,cause:K(t)}):new T("Unknown error",{...r,cause:t})}constructor(n,r){var i,u;const t=r==null?void 0:r.cause;super(n,{cause:t}),this.meta=r==null?void 0:r.meta,this.cause=t,this.shape=(i=r==null?void 0:r.result)==null?void 0:i.error,this.data=(u=r==null?void 0:r.result)==null?void 0:u.error.data,this.name="TRPCClientError",Object.setPrototypeOf(this,T.prototype)}}const j=e=>typeof e=="function";function te(e){if(e)return e;if(typeof window<"u"&&j(window.fetch))return window.fetch;if(typeof globalThis<"u"&&j(globalThis.fetch))return globalThis.fetch;throw new Error("No fetch implementation found")}function re(e){return e||(typeof window<"u"&&window.AbortController?window.AbortController:typeof globalThis<"u"&&globalThis.AbortController?globalThis.AbortController:null)}function ne(e){return{url:e.url.toString().replace(/\/$/,""),fetch:e.fetch,AbortController:re(e.AbortController)}}function oe(e){const n={};for(let r=0;r<e.length;r++){const t=e[r];n[r]=t}return n}const ie={query:"GET",mutation:"POST"};function L(e){return"input"in e?e.runtime.transformer.serialize(e.input):oe(e.inputs.map(n=>e.runtime.transformer.serialize(n)))}const v=e=>{let n=e.url+"/"+e.path;const r=[];if("inputs"in e&&r.push("batch=1"),e.type==="query"){const t=L(e);t!==void 0&&r.push(`input=${encodeURIComponent(JSON.stringify(t))}`)}return r.length&&(n+="?"+r.join("&")),n},ae=e=>{if(e.type==="query")return;const n=L(e);return n!==void 0?JSON.stringify(n):void 0},ue=e=>ce({...e,contentTypeHeader:"application/json",getUrl:v,getBody:ae});async function se(e,n){const r=e.getUrl(e),t=e.getBody(e),{type:i}=e,u=await e.headers();/* istanbul ignore if -- @preserve */if(i==="subscription")throw new Error("Subscriptions should use wsLink");const a={...e.contentTypeHeader?{"content-type":e.contentTypeHeader}:{},...e.batchModeHeader?{"trpc-batch-mode":e.batchModeHeader}:{},...u};return te(e.fetch)(r,{method:ie[i],signal:n==null?void 0:n.signal,body:t,headers:a})}function ce(e){const n=e.AbortController?new e.AbortController:null,r={};let t=!1;return{promise:new Promise((a,c)=>{se(e,n).then(o=>(r.response=o,t=!0,o.json())).then(o=>{r.responseJSON=o,a({json:o,meta:r})}).catch(o=>{t=!0,c(T.from(o,{meta:r}))})}),cancel:()=>{t||n==null||n.abort()}}}const P=()=>{throw new Error("Something went wrong. Please submit an issue at https://github.com/trpc/trpc/issues/new")};function S(e){let n=null,r=null;const t=()=>{clearTimeout(r),r=null,n=null};function i(c){var b,h;const o=[[]];let s=0;for(;;){const f=c[s];if(!f)break;const d=o[o.length-1];if(f.aborted){(b=f.reject)==null||b.call(f,new Error("Aborted")),s++;continue}if(e.validate(d.concat(f).map(l=>l.key))){d.push(f),s++;continue}if(d.length===0){(h=f.reject)==null||h.call(f,new Error("Input is too big for a single dispatch")),s++;continue}o.push([])}return o}function u(){const c=i(n);t();for(const o of c){if(!o.length)continue;const s={items:o,cancel:P};for(const d of o)d.batch=s;const b=(d,m)=>{var y;const l=s.items[d];(y=l.resolve)==null||y.call(l,m),l.batch=null,l.reject=null,l.resolve=null},{promise:h,cancel:f}=e.fetch(s.items.map(d=>d.key),b);s.cancel=f,h.then(d=>{var m;for(let l=0;l<d.length;l++){const y=d[l];b(l,y)}for(const l of s.items)(m=l.reject)==null||m.call(l,new Error("Missing result")),l.batch=null}).catch(d=>{var m;for(const l of s.items)(m=l.reject)==null||m.call(l,d),l.batch=null})}}function a(c){const o={aborted:!1,key:c,batch:null,resolve:P,reject:P},s=new Promise((h,f)=>{o.reject=f,o.resolve=h,n||(n=[]),n.push(o)});return r||(r=setTimeout(u)),{promise:s,cancel:()=>{var h;o.aborted=!0,(h=o.batch)!=null&&h.items.every(f=>f.aborted)&&(o.batch.cancel(),o.batch=null)}}}return{load:a}}function le(e){return function(r){const t=ne(r),i=r.maxURLLength??1/0;return u=>{const a=h=>{const f=m=>{if(i===1/0)return!0;const l=m.map(w=>w.path).join(","),y=m.map(w=>w.input);return v({...t,runtime:u,type:h,path:l,inputs:y}).length<=i},d=e({...t,runtime:u,type:h,opts:r});return{validate:f,fetch:d}},c=S(a("query")),o=S(a("mutation")),s=S(a("subscription")),b={query:c,subscription:s,mutation:o};return({op:h})=>C(f=>{const d=b[h.type],{promise:m,cancel:l}=d.load(h);let y;return m.then(g=>{y=g;const w=W(g.json,u);if(!w.ok){f.error(T.from(w.error,{meta:g.meta}));return}f.next({context:g.meta,result:w.result}),f.complete()}).catch(g=>{f.error(T.from(g,{meta:y==null?void 0:y.meta}))}),()=>{l()}})}}}const fe=e=>n=>{const r=n.map(a=>a.path).join(","),t=n.map(a=>a.input),{promise:i,cancel:u}=ue({...e,path:r,inputs:t,headers(){return e.opts.headers?typeof e.opts.headers=="function"?e.opts.headers({opList:n}):e.opts.headers:{}}});return{promise:i.then(a=>(Array.isArray(a.json)?a.json:n.map(()=>a.json)).map(s=>({meta:a.meta,json:s}))),cancel:u}},de=le(fe);class he{$request({type:n,input:r,path:t,context:i={}}){return V({links:this.links,op:{id:++this.requestId,type:n,path:t,input:r,context:i}}).pipe(M())}requestAsPromise(n){const r=this.$request(n),{promise:t,abort:i}=F(r);return new Promise((a,c)=>{var o;(o=n.signal)==null||o.addEventListener("abort",i),t.then(s=>{a(s.result.data)}).catch(s=>{c(T.from(s))})})}query(n,r,t){return this.requestAsPromise({type:"query",path:n,input:r,context:t==null?void 0:t.context,signal:t==null?void 0:t.signal})}mutation(n,r,t){return this.requestAsPromise({type:"mutation",path:n,input:r,context:t==null?void 0:t.context,signal:t==null?void 0:t.signal})}subscription(n,r,t){return this.$request({type:"subscription",path:n,input:r,context:t==null?void 0:t.context}).subscribe({next(u){var a,c,o;u.result.type==="started"?(a=t.onStarted)==null||a.call(t):u.result.type==="stopped"?(c=t.onStopped)==null||c.call(t):(o=t.onData)==null||o.call(t,u.result.data)},error(u){var a;(a=t.onError)==null||a.call(t,u)},complete(){var u;(u=t.onComplete)==null||u.call(t)}})}constructor(n){this.requestId=0;const r=(()=>{const t=n.transformer;return t?"input"in t?n.transformer:{input:t,output:t}:{input:{serialize:i=>i,deserialize:i=>i},output:{serialize:i=>i,deserialize:i=>i}}})();this.runtime={transformer:{serialize:t=>r.input.serialize(t),deserialize:t=>r.output.deserialize(t)},combinedTransformer:r},this.links=n.links.map(t=>t(this.runtime))}}const me={query:"query",mutate:"mutation",subscribe:"subscription"},pe=e=>me[e];function ye(e){return Y(n=>e.hasOwnProperty(n)?e[n]:n==="__untypedClient"?e:J(({path:r,args:t})=>{const i=[n,...r],u=pe(i.pop()),a=i.join(".");return e[u](a,...t)}))}function Te(e){const n=new he(e);return ye(n)}const be=Te({links:[de({url:"/api/trpc"})]});function ge({initialTodoItems:e}){const[n,r]=R.useState(e),[t,i]=R.useState("");return p.jsxs(p.Fragment,{children:[p.jsx("ul",{children:n.map((u,a)=>p.jsx("li",{children:u.text},a))}),p.jsx("div",{children:p.jsxs("form",{onSubmit:async u=>{u.preventDefault(),r(a=>[...a,{text:t}]);try{await be.onNewTodo.mutate(t),i("")}catch(a){console.error(a),r(c=>c.slice(0,-1))}},children:[p.jsx("input",{type:"text",onChange:u=>i(u.target.value),value:t})," ",p.jsx("button",{type:"submit",children:"Add to-do"})]})})]})}function we(){const e=$();return p.jsxs(p.Fragment,{children:[p.jsx("h1",{children:"To-do List"}),p.jsx(ge,{initialTodoItems:e.todo})]})}const xe=Object.freeze(Object.defineProperty({__proto__:null,default:we},Symbol.toStringTag,{value:"Module"})),Ce={isClientRuntimeLoaded:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:!0}},onBeforeRenderEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:null}},dataEnv:{type:"computed",definedAtData:null,valueSerialized:{type:"js-serialized",value:{server:!0}}},Loading:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/components/Loading",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:I}},onRenderClient:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/__internal/integration/onRenderClient",fileExportPathToShowToUser:[]},valueSerialized:{type:"pointer-import",value:_}},hydrationCanBeAborted:{type:"standard",definedAtData:{filePathToShowToUser:"vike-react/config",fileExportPathToShowToUser:["default","hydrationCanBeAborted"]},valueSerialized:{type:"js-serialized",value:!0}},Layout:{type:"cumulative",definedAtData:[{filePathToShowToUser:"/layouts/LayoutDefault.tsx",fileExportPathToShowToUser:[]}],valueSerialized:[{type:"pointer-import",value:N}]},title:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+config.ts",fileExportPathToShowToUser:["default","title"]},valueSerialized:{type:"js-serialized",value:"My Vike App"}},onPageTransitionEnd:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionEnd.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:k}},onPageTransitionStart:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/+onPageTransitionStart.ts",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:q}},Page:{type:"standard",definedAtData:{filePathToShowToUser:"/pages/todo/+Page.tsx",fileExportPathToShowToUser:[]},valueSerialized:{type:"plus-file",exportValues:xe}}};export{Ce as configValuesSerialized};
